(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{541:function(e,n,l){"use strict";l.r(n);var t=l(70),r=Object(t.a)({},(function(){var e=this,n=e.$createElement,l=e._self._c||n;return l("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[l("h1",{attrs:{id:"富文本编辑器"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#富文本编辑器"}},[e._v("#")]),e._v(" 富文本编辑器")]),e._v(" "),l("ul",[l("li",[e._v("用")])]),e._v(" "),l("div",{staticClass:"language- extra-class"},[l("pre",{pre:!0,attrs:{class:"language-text"}},[l("code",[e._v('<Editor v-model="noticeContent" />\n')])])]),l("ul",[l("li",[e._v("引")])]),e._v(" "),l("div",{staticClass:"language- extra-class"},[l("pre",{pre:!0,attrs:{class:"language-text"}},[l("code",[e._v("import Editor from '@/components/Editor';\ncomponents: {\n\tEditor\n}\nnoticeContent:\"\"\n")])])]),l("ul",[l("li",[e._v("源")])]),e._v(" "),l("div",{staticClass:"language- extra-class"},[l("pre",{pre:!0,attrs:{class:"language-text"}},[l("code",[e._v('<template>\n  <div>\n    \x3c!-- 图片上传组件辅助 --\x3e\n    <el-upload\n      class="avatar-uploader quill-img"\n      :action="uploadImgUrl"\n      name="file"\n      :headers="headers"\n      :show-file-list="false"\n      :on-success="quillImgSuccess"\n      :on-error="uploadError"\n      :before-upload="quillImgBefore"\n      accept=".jpg, .jpeg, .png, .gif"\n    ></el-upload>\n\n    \x3c!-- 富文本组件 --\x3e\n    <quill-editor\n      class="editor"\n      v-model="content"\n      ref="quillEditor"\n      :options="editorOption"\n      @blur="onEditorBlur($event)"\n      @focus="onEditorFocus($event)"\n      @change="onEditorChange($event)"\n    ></quill-editor>\n  </div>\n</template>\n\n<script>\nimport { getToken } from "@/utils/auth";\n\n// 工具栏配置\nconst toolbarOptions = [\n  ["bold", "italic", "underline", "strike"], // 加粗 斜体 下划线 删除线\n  ["blockquote", "code-block"], // 引用  代码块\n  [{ list: "ordered" }, { list: "bullet" }], // 有序、无序列表\n  [{ indent: "-1" }, { indent: "+1" }], // 缩进\n  [{ size: ["small", false, "large", "huge"] }], // 字体大小\n  [{ header: [1, 2, 3, 4, 5, 6, false] }], // 标题\n  [{ color: [] }, { background: [] }], // 字体颜色、字体背景颜色\n  [{ align: [] }], // 对齐方式\n  ["clean"], // 清除文本格式\n  ["link", "image", "video"], // 链接、图片、视频\n];\n\nimport { quillEditor } from "vue-quill-editor";\nimport "quill/dist/quill.core.css";\nimport "quill/dist/quill.snow.css";\nimport "quill/dist/quill.bubble.css";\n\nexport default {\n  props: {\n    /* 编辑器的内容 */\n    value: {\n      type: String,\n    },\n    /* 图片大小 */\n    maxSize: {\n      type: Number,\n      default: 4000, //kb\n    },\n  },\n  components: { quillEditor },\n  data() {\n    return {\n      content: this.value,\n      uploadImgUrl: "",\n      editorOption: {\n        placeholder: "",\n        theme: "snow", // or \'bubble\'\n        placeholder: "请输入内容",\n        modules: {\n          toolbar: {\n            container: toolbarOptions,\n            handlers: {\n              image: function (value) {\n                if (value) {\n                  // 触发input框选择图片文件\n                  document.querySelector(".quill-img input").click();\n                } else {\n                  this.quill.format("image", false);\n                }\n              },\n            },\n          },\n        },\n      },\n      uploadImgUrl: process.env.VUE_APP_BASE_API + "/common/upload", // 上传的图片服务器地址（这个地方注意）\n      headers: {\n        Authorization: "Bearer " + getToken(),（这个地方注意）\n      },\n    };\n  },\n  watch: {\n    value: function () {\n      this.content = this.value;\n    },\n  },\n  methods: {\n    onEditorBlur() {\n      //失去焦点事件\n    },\n    onEditorFocus() {\n      //获得焦点事件\n    },\n    onEditorChange() {\n      //内容改变事件\n      this.$emit("input", this.content);\n    },\n\n    // 富文本图片上传前\n    quillImgBefore(file) {\n      let fileType = file.type;\n      if (fileType === "image/jpeg" || fileType === "image/png") {\n        return true;\n      } else {\n        this.$message.error("请插入图片类型文件(jpg/jpeg/png)");\n        return false;\n      }\n    },\n\n    quillImgSuccess(res, file) {\n      // res为图片服务器返回的数据\n      // 获取富文本组件实例\n      let quill = this.$refs.quillEditor.quill;\n      // 如果上传成功\n      if (res.code == 200) {\n        // 获取光标所在位置\n        let length = quill.getSelection().index;\n        // 插入图片  res.url为服务器返回的图片地址\n        quill.insertEmbed(length, "image", res.url);\n        // 调整光标到最后\n        quill.setSelection(length + 1);\n      } else {\n        this.$message.error("图片插入失败");\n      }\n    },\n    // 富文本图片上传失败\n    uploadError() {\n      // loading动画消失\n      this.$message.error("图片插入失败");\n    },\n  },\n};\n<\/script> \n\n<style>\n.editor {\n  line-height: normal !important;\n  height: 692px;\n}\n.quill-img {\n  display: none;\n}\n.ql-snow .ql-tooltip[data-mode="link"]::before {\n  content: "请输入链接地址:";\n}\n.ql-snow .ql-tooltip.ql-editing a.ql-action::after {\n  border-right: 0px;\n  content: "保存";\n  padding-right: 0px;\n}\n\n.ql-snow .ql-tooltip[data-mode="video"]::before {\n  content: "请输入视频地址:";\n}\n\n.ql-snow .ql-picker.ql-size .ql-picker-label::before,\n.ql-snow .ql-picker.ql-size .ql-picker-item::before {\n  content: "14px";\n}\n.ql-snow .ql-picker.ql-size .ql-picker-label[data-value="small"]::before,\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value="small"]::before {\n  content: "10px";\n}\n.ql-snow .ql-picker.ql-size .ql-picker-label[data-value="large"]::before,\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value="large"]::before {\n  content: "18px";\n}\n.ql-snow .ql-picker.ql-size .ql-picker-label[data-value="huge"]::before,\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value="huge"]::before {\n  content: "32px";\n}\n\n.ql-snow .ql-picker.ql-header .ql-picker-label::before,\n.ql-snow .ql-picker.ql-header .ql-picker-item::before {\n  content: "文本";\n}\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value="1"]::before,\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="1"]::before {\n  content: "标题1";\n}\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value="2"]::before,\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="2"]::before {\n  content: "标题2";\n}\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value="3"]::before,\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="3"]::before {\n  content: "标题3";\n}\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value="4"]::before,\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="4"]::before {\n  content: "标题4";\n}\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value="5"]::before,\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="5"]::before {\n  content: "标题5";\n}\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value="6"]::before,\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="6"]::before {\n  content: "标题6";\n}\n\n.ql-snow .ql-picker.ql-font .ql-picker-label::before,\n.ql-snow .ql-picker.ql-font .ql-picker-item::before {\n  content: "标准字体";\n}\n.ql-snow .ql-picker.ql-font .ql-picker-label[data-value="serif"]::before,\n.ql-snow .ql-picker.ql-font .ql-picker-item[data-value="serif"]::before {\n  content: "衬线字体";\n}\n.ql-snow .ql-picker.ql-font .ql-picker-label[data-value="monospace"]::before,\n.ql-snow .ql-picker.ql-font .ql-picker-item[data-value="monospace"]::before {\n  content: "等宽字体";\n}\n</style>\n')])])])])}),[],!1,null,null,null);n.default=r.exports}}]);